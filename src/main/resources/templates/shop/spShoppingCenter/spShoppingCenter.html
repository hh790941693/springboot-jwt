<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head>
    <th:block th:include="common :: header"></th:block>
    <meta charset="UTF-8">
    <title>超市购物</title>

    <style>
        #mainDiv {
            width: 100%;
            height:100%;
            padding:30px 200px 15px 200px;
            overflow: hidden;
        }

        #searchDiv {
            width:100%;
            height:60px;
            padding: 0 30px 0 30px;
        }

        .goodsDiv {
            width:226px;
            height:367px;
            float:left;
            padding:20px;
            margin-right:5px;
            margin-bottom: 5px;
            border: 1px solid grey;
            text-align: center;
        }
        .goodsDiv p {
            text-align: left;
        }

        .selected {
            border:1px solid red;
            z-index:2;
        }
        p {
            margin-top:5px;
        }
    </style>
</head>
<body>
    <div id="mainDiv">
        <div id="searchDiv">
            <div style="width:150px;float:left;">
                <span>商品名称 :</span>
                <input id="goodsName">
            </div>
            <div style="width:150px;float:left;margin-left:50px;">
                <span>店铺名称 :</span>
                <input id="merchantName">
            </div>

            <div style="width:160px;float:left;margin-left:50px;">
                <div>
                    <span>价格排序 :</span>
                </div>
                <div>
                    <span>升序: </span><input type="radio" v-model="priceSort" value="true">&nbsp;&nbsp;
                    <span>降序: </span><input type="radio" v-model="priceSort" value="false">
                </div>
            </div>

            <div style="width:130px;float:left;margin-left:50px;">
                <div>
                    <span>销量排序 :</span>
                </div>
                <div>
                    <span>升序: </span><input type="radio" v-model="saleNumberSort" value="true">&nbsp;&nbsp;
                    <span>降序: </span><input type="radio" v-model="saleNumberSort" value="false">
                </div>
            </div>

            <div style="width:130px;float:right;margin-left:15px;">
                <button @click="queryGoodsList()" class="btn btn-sm btn-primary">搜索</button>
                <button @click="resetSearch()" class="btn btn-sm btn-default">重置</button>
            </div>
        </div>
        <hr />
        <div id="innerDiv" style="width:100%;height:calc(100% - 60px);overflow-y: auto;">
            <div class="goodsDiv" v-for="(goodsDetail,index) in goodsData" @mouseenter="mouseEnter(index)" @mouseleave="mouseLeave(index)">
                <div style="width:184px;height:188px;">
                    <img :src="goodsDetail.backImage" style="width:calc(100% - 20px);height:calc(100% - 20px);">
                </div>
                <p>{{goodsDetail.name}}</p>
                <div style="width:100%;height:30px;">
                    <div style="width:50%;float:left;text-align: left;">
                        <span style="font-weight: bold;color: red;font-size: 18px;">￥{{goodsDetail.salePrice}}</span>&nbsp;<span style="text-decoration:line-through;color:grey;">￥{{goodsDetail.originalPrice}}</span>
                    </div>
                    <div style="width:50%;float:right;">
                        <button class="btn btn-sm btn-primary"><i class="fa fa-shopping-cart"></i>加入购物车</button>
                    </div>
                </div>

                <div style="height:25px;margin-top: 5px;font-size: 17px;">
                    <p><i class="fa fa-home">{{goodsDetail.merchantName}}</i></p>
                </div>
                <hr/>
                <div>
                    <span style="width:49%;display:inline-block;text-align: left;">
                        库存 {{goodsDetail.stockNum}}
                    </span>
                    <span style="width:49%;display:inline-block;text-align: right;">
                        月销 {{goodsDetail.saleNumber}}
                    </span>
                </div>
            </div>
        </div>
    </div>
    <th:block th:include="common :: footer"></th:block>
</body>

    <script>
        var app = new Vue({
            el: '#mainDiv',
            data: {
                goodsData: {},
                priceSort: true,
                saleNumberSort: false,
            },
            methods: {
                queryGoodsList: function () {
                    // 查询商品列表
                    var loadIndex = layer.load(1, {
                        shade: [0.1,'#fff'] //0.1透明度的白色背景
                    });
                    $.ajax({
                        type: "GET",
                        url: "/shop/shoppingCenter/queryGoodsList",
                        data: {
                            'name':$("#goodsName").val(),
                            'merchantName':$("#merchantName").val(),
                            'priceSort':this.priceSort,
                            'saleNumberSort': this.saleNumberSort,
                        },
                        success: function (result) {
                            layer.close(loadIndex);
                            if (result.code == 1) {
                                app.goodsData = result.data;
                            }
                        }
                    });
                },
                mouseEnter: function (index) {
                    $("#innerDiv").children("div").eq(index).css("border", '');
                    $("#innerDiv").children("div").eq(index).addClass("selected");
                    $("#innerDiv").children("div").eq(index).children("div").eq(0).children("img").eq(0).animate({width:"100%",height:"100%"});
                },
                mouseLeave: function (index) {
                    $("#innerDiv").children("div").eq(index).removeClass("selected");
                    $("#innerDiv").children("div").eq(index).css("border", '1px solid grey');
                    $("#innerDiv").children("div").eq(index).children("div").eq(0).children("img").eq(0).animate({width:"164px",height:"168px"});
                },
                resetSearch: function () {
                    $("#goodsName").val("");
                    $("#merchantName").val("");
                    app.priceSort = true;
                    app.saleNumberSort = false;
                    this.queryGoodsList();
                }
            },
            created: function () {
                this.queryGoodsList();
            }
        });
    </script>
</html>