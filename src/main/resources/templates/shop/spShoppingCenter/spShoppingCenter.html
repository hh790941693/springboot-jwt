<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head>
    <th:block th:include="common :: header"></th:block>
    <meta charset="UTF-8">
    <title>超市购物</title>

    <style>
        #mainDiv {
            width: 1200px;
            height:auto;
            overflow-y: scroll;
            max-width: 1600px;
            min-height: 800px;
            border:1px solid red;
            padding:30px 15px 15px 15px;
        }

        #searchDiv {
            width:100%;
            height:60px;
            padding: 0 30px 0 30px;
        }

        .goodsDiv {
            width:226px;
            height:367px;
            float:left;
            padding:20px;
            margin-right:5px;
            border: 1px solid grey;
            text-align: center;
        }
        .goodsDiv p {
            text-align: left;
        }

        .selected {
            border:1px solid red;
            z-index:2;
        }
        p {
            margin-top:5px;
        }
    </style>
</head>
<body>
    <div id="mainDiv">
        <div id="searchDiv">
            <div style="width:150px;float:left;">
                <span>商品名称 :</span>
                <input id="goodsName">
            </div>
            <div style="width:150px;float:left;margin-left:50px;">
                <span>店铺名称 :</span>
                <input id="merchantName">
            </div>

            <div style="width:160px;float:left;margin-left:50px;">
                <div>
                    <span>价格排序 :</span>
                </div>
                <div>
                    <span>升序: </span><input type="radio" v-model="priceSort" value="true">&nbsp;&nbsp;
                    <span>降序: </span><input type="radio" v-model="priceSort" value="false">
                </div>
            </div>

            <div style="width:130px;float:left;margin-left:50px;">
                <div>
                    <span>销量排序 :</span>
                </div>
                <div>
                    <span>升序: </span><input type="radio" v-model="saleNumberSort" value="true">&nbsp;&nbsp;
                    <span>降序: </span><input type="radio" v-model="saleNumberSort" value="false">
                </div>
            </div>

            <div style="width:130px;float:right;margin-left:15px;">
                <button @click="queryGoodsList()" class="btn btn-sm btn-primary">搜索</button>
                <button @click="resetSearch()" class="btn btn-sm btn-default">重置</button>
            </div>
        </div>
        <div id="innerDiv" style="width:100%;height:100%;">
            <div class="goodsDiv" v-for="(goodsDetail,index) in goodsData" @mouseenter="mouseEnter(index)" @mouseleave="mouseLeave(index)">
                <div style="width:184px;height:188px;">
                    <img :src="goodsDetail.backImage" style="width:calc(100% - 20px);height:calc(100% - 20px);">
                </div>
                <p>{{goodsDetail.name}}</p>
                <p><span style="font-weight: bold;color: red;font-size: 18px;">￥{{goodsDetail.salePrice}}</span>&nbsp;<span style="text-decoration:line-through;color:grey;">￥{{goodsDetail.originalPrice}}</span></p>
                <p><button>加入购物车</button></p>
                <p><span class="fa fa-home"></span>{{goodsDetail.merchantName}}</p>
                <hr/>
                <p style="text-align: right;">
                    月销 {{goodsDetail.saleNumber}}
                </p>
            </div>
        </div>

    </div>
    <th:block th:include="common :: footer"></th:block>
</body>

    <script>
        var app = new Vue({
            el: '#mainDiv',
            data: {
                goodsData: {},
                priceSort: true,
                saleNumberSort: false,
            },
            methods: {
                queryGoodsList: function () {
                    // 查询歌曲列表
                    $.ajax({
                        type: "GET",
                        url: "/shop/shoppingCenter/queryGoodsList",
                        data: {
                            'name':$("#goodsName").val(),
                            'merchantName':$("#merchantName").val(),
                            'priceSort':this.priceSort,
                            'saleNumberSort': this.saleNumberSort,
                        },
                        success: function (result) {
                            if (result.code == 1) {
                                app.goodsData = result.data;
                            }
                        }
                    });
                },
                mouseEnter: function (index) {
                    $("#innerDiv").children("div").eq(index).css("border", '');
                    $("#innerDiv").children("div").eq(index).addClass("selected");
                    $("#innerDiv").children("div").eq(index).children("div").eq(0).children("img").eq(0).animate({width:"100%",height:"100%"});
                },
                mouseLeave: function (index) {
                    $("#innerDiv").children("div").eq(index).removeClass("selected");
                    $("#innerDiv").children("div").eq(index).css("border", '1px solid grey');
                    $("#innerDiv").children("div").eq(index).children("div").eq(0).children("img").eq(0).animate({width:"164px",height:"168px"});
                },
                resetSearch: function () {
                    $("#goodsName").val("");
                    $("#merchantName").val("");
                    this.queryGoodsList();
                }
            },
            created: function () {
                this.queryGoodsList();
            }
        });
    </script>
</html>