<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head th:include="common :: header"></head>
        <meta charset="UTF-8">
        <title>网易新闻</title>
        <style>
            #mainDiv{
                width:70%;
                height:100%;
                margin:0 auto;
                border:1px solid grey;
                padding:10px;
            }

            #headDiv{
                height:5%;
                border-bottom: 1px solid grey;
            }

            #headDiv ul{
                width:100%;
                height:100%;
            }

            #headDiv ul li{
                float:left;
                width:7%;
                height:90%;
                font-size: 16px;
                cursor: pointer;
            }

            #contentDiv{
                height:95%;
                margin-top: 5px;
                overflow-y: scroll;
            }
        </style>
    </head>

    <body>
        <div id="mainDiv">
            <div id="headDiv">
                <ul>
                   <li v-for="(row, i) in typeList" @click="listNews(i)" :id="row.docId" th:align="center">
                       {{row.newsType}}
                   </li>
                </ul>
            </div>
            <div id="contentDiv">
                <div v-for="row in contentList" style="height:72px;width:100%;">
                    <div style="width:20%;">
                        <img width="50" height="50" :src="row.imgsrc" style="float: left;">
                    </div>
                    <div style="width:60%;float: left;padding-left: 13px;">
                        <p style="font-weight: bold;font-size: 15px;">
                            {{row.title}}
                        </p>
                        <p>
                            {{row.digest}}
                        </p>
                        <a :href="row.url" target="_blank" style="color:blue;">查看详情</a>
                    </div>
                    <div style="width:30%;float: right;">
                        <p>评论数:<span>{{row.commentCount}}</span></p>
                        <p>发布时间:<span>{{row.ptime}}</span></p>
                    </div>
                </div>
            </div>
        </div>


        <div th:include="common::footer"></div>
    </body>
    <script>
        var app = new Vue({
            el: '#mainDiv',
            data: {
                typeList:{},
                contentList:{},
                selectedIndex:0,
            },
            methods: {
                queryNewsTypeList:function () {
                    //查询朋友圈列表
                    $.ajax({
                        type: "GET",
                        url: rootUrl+'ws/queryWangyiNewsType',
                        success: function (result) {
                            if (result.code == 0){
                                return;
                            }
                            app.typeList = result.data;

                            app.listNews(app.selectedIndex);
                        }
                    });
                },
                listNews:function (index) {
                    app.selectedIndex = index;
                    var selectedInfo = app.typeList[app.selectedIndex];
                    var docId = selectedInfo.docId;

                    $.ajax({
                        type: "GET",
                        dataType: "jsonp",
                        jsonp: "callback",
                        jsonpCallback: "artiList",
                        url: selectedInfo.url + "/0-20.html",
                        success: function (result) {
                            app.contentList = result[docId];

                            $('#headDiv ul li').css("background-color", "").css("color","black");
                            $('#headDiv ul li[id="'+docId+'"]').css("background-color","blue").css("color","white");
                        }
                    });
                }
            },
            created: function () {
                this.queryNewsTypeList();
            }
        });
    </script>
</html>