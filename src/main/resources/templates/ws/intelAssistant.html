<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script type="text/javascript" th:src="@{/js/jquery/jquery.min.js?v=2.1.4}"></script>
    <title>PC机器人聊天界面</title>
    <style>
        .box{
            width: 99%;
            height: 500px;
            position:absolute;
            top:0;
        }
        #content{
            width: 98%;
            height: 500px;
            margin-right:1%;
            margin-left:1%;
        }
        #chatDiv{
            width: 100%;
            height:58px;
            line-height:40px;
            border-top:1px solid #ccc;
            position:absolute;
            bottom:0;
            left:0;
        }
        #content div img{
            border:1px solid #ccc;
            border-radius:7px;
            padding:2px;
            cursor:pointer;
            margin:5px 0 0 5px;
            float:left;
            width:40px;
            height:40px;
        }
        #content div input[type='text']{
            width:80%;
            height:40px;
            line-height:27px;
            border-radius:7px;
            border:1px solid #ccc;
            float:left;
            margin-left:5px;
            margin-top:5px;
            outline:none;
            padding:0 5px;
        }
        #content div input[type='button']{
            width:12%;
            height: 40px;
            border-radius:5px;
            background:#fff;
            border:none;
            margin-left:1%;
            cursor:pointer;
            font-size:27px;
            margin-top:5px;
        }

        .info_box{
            width: 100%;
            height:440px;
            overflow-y:auto;
        }
        .info_box::-webkit-scrollbar {display:none}
        .info_box div{
            margin:0 0 5px;
            position:relative;
        }
        .info_box .info_r{

        }
        .info_box .info_l{

        }
        .info_box .info_l img{
            position:absolute;
            left:0;
            top:0;
        }
        .info_box .info_r img{
            position:absolute;
            right:0;
            top:0;
        }
        .info_box .info_l span{margin-left: 60px;margin-top:16px;}
        .info_box .info_r span{margin-left:41%;margin-top:16px;text-align: right;}

        .info_box span{
            width: 53%;
            height: auto;
            font-size:14px;
            background:#ddd;
            border-radius: 10px;
            padding:8px;
            color:#333;
            display: block;
            position:relative;
            top:0;
        }

        .info_r span{
            color: blue;
        }

        .info_box .info_l img{
            float:left;
            width:50px;
            height:50px;
        }
        .info_r img{
            float:right;
            width:50px;
            height:50px;
        }
    </style>
</head>
<body>
    <div class="box">
        <div id="content">
            <div class="info_box">
                <div class="info_r">
                    <img src="../img/man.jpg" class='pic_r'>
                    <span class='infor'>小二，小二！！</span>
                </div>
                <div class="info_l">
                    <img src="../img/car.jpg" class='pic_l'>
                    <span class='infoo'>主人，我在。请问我有什么可以帮助您的？</span>
                </div>
            </div>
            <div id="chatDiv">
                <img src="../img/man.jpg" id='pic'>
                <input type="text" placeholder='尽情畅聊吧' id='inp'>
                <input type="button" value='发送' id='btnSend'>
            </div>
        </div>
    </div>

    <script>
        var info_box = document.getElementsByClassName('info_box')[0];
        $("#btnSend").click(function(){
            var content = $("#inp").val();
            if(content === ''){
                alert('请输入内容');
            }else{
                // 人类
                var nDiv = document.createElement('div');
                var spans = document.createElement('span');
                var imgs = document.createElement('img');
                var sTxt = document.createTextNode(content);

                spans.appendChild(sTxt);
                nDiv.appendChild(spans);
                nDiv.appendChild(imgs);
                info_box.insertBefore(nDiv,info_box.lastChild);
                spans.className='infor';
                nDiv.className='info_r';
                imgs.src='../img/man.jpg';

                $.ajax({
                    type: "GET",
                    url: '/ws/robotChat?text='+content,
                    success: function (result) {
                        // 机器人
                        var nDiv = document.createElement('div');
                        var spans = document.createElement('span');
                        var imgs = document.createElement('img');
                        var sTxt = document.createTextNode(result);
                        spans.appendChild(sTxt);
                        nDiv.appendChild(spans);
                        nDiv.appendChild(imgs);
                        info_box.insertBefore(nDiv,info_box.lastChild);
                        spans.className='infol';
                        nDiv.className='info_l';
                        imgs.src='../img/car.jpg';

                        let scrollHeight = $(".info_box")[0].scrollHeight;
                        let height = $(".info_box").height();
                        $(".info_box").scrollTop(scrollHeight - height);
                    }
                });
            }
            $("#inp").val("");
        });
    </script>
</body>
</html>